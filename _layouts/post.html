---
layout: default
---

<article>
  {% include meta.html post=page %}
  {{ content }}

  <div class="post-tags-categories">
    {% if page.tags.size > 0 %}
      <div class="tags">
        <strong>Tags:</strong>
        {% for tag in page.tags %}
          <a href="{{ site.baseurl }}/tags/{{ tag | slugify }}/">{{ tag }}</a>{% unless forloop.last %}, {% endunless %}
        {% endfor %}
      </div>
    {% endif %}
    {% if page.categories.size > 0 %}
      <div class="categories">
        <strong>Categories:</strong>
        {% for category in page.categories %}
          <a href="{{ site.baseurl }}/categories/{{ category | slugify }}/">{{ category }}</a>{% unless forloop.last %}, {% endunless %}
        {% endfor %}
      </div>
    {% endif %}
  </div>

  {% if page.comments != false and site.comments.isso or site.comments.disqus %}
    <hr>
    {% if site.comments.isso_domain %}<div id="isso-thread"></div>{% endif %}
    {% if site.comments.disqus_shortname %}<div id="disqus_thread"></div>{% endif %}
    <noscript>Please enable JavaScript to view comments.</noscript>
  {% endif %}

{%- if site.giscus -%}
<section class="page__comments">
  <script src="https://giscus.app/client.js"
          data-repo="{{ site.giscus.repo }}"
          data-repo-id="{{ site.giscus.repo_id }}"
          data-category="{{ site.giscus.category }}"
          data-category-id="{{ site.giscus.category_id }}"
          data-mapping="{{ site.giscus.mapping }}"
          data-strict="{{ site.giscus.strict }}"
          data-reactions-enabled="{{ site.giscus.reactions_enabled }}"
          data-emit-metadata="{{ site.giscus.emit_metadata }}"
          data-input-position="{{ site.giscus.input_position }}"
          data-theme="{{ site.giscus.theme }}"
          data-lang="{{ site.giscus.lang }}"
          data-loading="{{ site.giscus.loading }}"
          crossorigin="anonymous"
          async>
  </script>
</section>
{%- endif -%}
</article>

<script src="/assets/js/clipboard.min.js"></script>
<script>
  document.addEventListener('DOMContentLoaded', function() {
    // Revised script logic:
    // Select all potential containers of code blocks
    // Rouge typically wraps in figure.highlight, div.highlight, or just pre.highlight
    var highlightContainers = document.querySelectorAll('figure.highlight, div.highlight, pre.highlight');

    highlightContainers.forEach(function(container, index) {
      var preElement = container.querySelector('pre');
      if (!preElement && container.tagName === 'PRE') {
        preElement = container; // container itself is pre.highlight
      }

      if (!preElement) return; // Should not happen if selector is correct

      // Ensure the preElement has an ID for clipboard.js target
      if (!preElement.id) {
        preElement.id = 'codeblock-for-copy-' + index;
      }

      // Make the container relative for absolute positioning of the button
      if (getComputedStyle(container).position === 'static') {
        container.style.position = 'relative';
      }

      // Create the button
      var button = document.createElement('button');
      button.className = 'btn btn-copy'; // Use existing styling
      button.innerHTML = 'Copy';
      button.setAttribute('data-clipboard-target', '#' + preElement.id);

      // Style the button for top-right corner
      button.style.position = 'absolute';
      button.style.top = '0.5em';
      button.style.right = '0.5em';
      button.style.zIndex = '10';
      button.style.padding = '0.25em 0.5em'; // Re-apply some basic padding if needed
      button.style.fontSize = '0.8em';      // Re-apply font size
      // Note: Main styling comes from _sass/copy-button.sass

      // Add the button to the container
      container.appendChild(button);
    });

    // Initialize ClipboardJS (should be existing)
    var clipboard = new ClipboardJS('.btn-copy');

    clipboard.on('success', function(e) {
      e.trigger.innerHTML = 'Copied!';
      setTimeout(function() {
        e.trigger.innerHTML = 'Copy';
      }, 2000);
      e.clearSelection();
    });

    clipboard.on('error', function(e) {
      // Optionally provide more specific error feedback
      // For example, if it's a browser that doesn't support execCommand
      var originalText = e.trigger.innerHTML;
      e.trigger.innerHTML = 'Error!'; // Or 'Press Ctrl+C'
      setTimeout(function() {
        e.trigger.innerHTML = originalText; // Or 'Copy'
      }, 2000);
    });
  });
</script>
