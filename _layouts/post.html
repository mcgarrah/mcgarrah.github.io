---
layout: default
---

<article>
  {% include meta.html post=page %}
  {{ content }}

  <div class="post-tags-categories">
    {% if page.tags.size > 0 %}
      <div class="tags">
        <strong>Tags:</strong>
        {% for tag in page.tags %}
          <a href="{{ site.baseurl }}/tags/{{ tag | slugify }}/">{{ tag }}</a>{% unless forloop.last %}, {% endunless %}
        {% endfor %}
      </div>
    {% endif %}
    {% if page.categories.size > 0 %}
      <div class="categories">
        <strong>Categories:</strong>
        {% for category in page.categories %}
          <a href="{{ site.baseurl }}/categories/{{ category | slugify }}/">{{ category }}</a>{% unless forloop.last %}, {% endunless %}
        {% endfor %}
      </div>
    {% endif %}
  </div>

  {% if page.comments != false and site.comments.isso or site.comments.disqus %}
    <hr>
    {% if site.comments.isso_domain %}<div id="isso-thread"></div>{% endif %}
    {% if site.comments.disqus_shortname %}<div id="disqus_thread"></div>{% endif %}
    <noscript>Please enable JavaScript to view comments.</noscript>
  {% endif %}

{%- if site.giscus -%}
<section class="page__comments">
  <script src="https://giscus.app/client.js"
          data-repo="{{ site.giscus.repo }}"
          data-repo-id="{{ site.giscus.repo_id }}"
          data-category="{{ site.giscus.category }}"
          data-category-id="{{ site.giscus.category_id }}"
          data-mapping="{{ site.giscus.mapping }}"
          data-strict="{{ site.giscus.strict }}"
          data-reactions-enabled="{{ site.giscus.reactions_enabled }}"
          data-emit-metadata="{{ site.giscus.emit_metadata }}"
          data-input-position="{{ site.giscus.input_position }}"
          data-theme="{{ site.giscus.theme }}"
          data-lang="{{ site.giscus.lang }}"
          data-loading="{{ site.giscus.loading }}"
          crossorigin="anonymous"
          async>
  </script>
</section>
{%- endif -%}
</article>

<script src="/assets/js/clipboard.min.js"></script>
<script>
document.addEventListener('DOMContentLoaded', function() {
  // Find all <pre> elements that are likely to contain highlighted code.
  var codePres = document.querySelectorAll('figure.highlight pre, div.highlight pre, pre.highlight');

  codePres.forEach(function(preElement, index) {
    // Ensure this pre element hasn't already been processed
    if (preElement.classList.contains('copy-button-added')) {
      return;
    }

    // Determine the "button container"
    var buttonContainer = preElement.closest('figure.highlight, div.highlight');
    if (!buttonContainer) {
      if (preElement.classList.contains('highlight')) {
        buttonContainer = preElement;
      } else {
        // Fallback, should be rare with specific selectors
        buttonContainer = preElement.parentNode;
      }
    }

    // Ensure the preElement has an ID for clipboard.js target
    if (!preElement.id) {
      preElement.id = 'codeblock-for-copy-' + index;
    }

    // Make the buttonContainer relative for absolute positioning
    // Avoid styling body if it's the unlikely parentNode fallback
    if (buttonContainer && buttonContainer.tagName !== 'BODY' && getComputedStyle(buttonContainer).position === 'static') {
      buttonContainer.style.position = 'relative';
    }

    // Create the button
    var button = document.createElement('button');
    button.className = 'btn btn-copy'; // Main styling from SASS
    button.innerHTML = 'Copy';
    button.setAttribute('data-clipboard-target', '#' + preElement.id);

    // Explicitly set styles for position and appearance (consistent with SASS intention)
    button.style.position = 'absolute';
    button.style.top = '0.5em';
    button.style.right = '0.5em';
    button.style.zIndex = '10';
    button.style.padding = '0.25em 0.5em';
    button.style.fontSize = '0.8em';

    if (buttonContainer) {
        buttonContainer.appendChild(button);
    } else {
        // Fallback if buttonContainer is somehow null (e.g. preElement was detached)
        // This is defensive and should ideally not be reached.
        preElement.parentNode.insertBefore(button, preElement);
    }

    preElement.classList.add('copy-button-added'); // Mark as processed
  });

  // Initialize ClipboardJS
  if (document.querySelector('.btn-copy')) { // Only initialize if buttons exist
    var clipboard = new ClipboardJS('.btn-copy');

    clipboard.on('success', function(e) {
      e.trigger.innerHTML = 'Copied!';
      setTimeout(function() { e.trigger.innerHTML = 'Copy'; }, 2000);
      e.clearSelection();
    });

    clipboard.on('error', function(e) {
      var originalText = e.trigger.innerHTML; // Changed to 'Copy' from originalText which might be 'Error!'
      e.trigger.innerHTML = 'Error!';
      setTimeout(function() { e.trigger.innerHTML = 'Copy'; }, 2000);
    });
  }
});
</script>
